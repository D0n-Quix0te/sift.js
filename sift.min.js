(function(){var o=new function(){var d=this.test=function(a,b){for(var c=a.exprs,e=0,d=c.length;e<d;e++){var l=c[e];if(!l.e(l.v,b instanceof Date?b.getTime():b,b))return!1}return!0},h=this.parse=function(a,b){var c=[];if(a)if(a.constructor==Object)for(var e in a){var f=i[e]?e:"$trav",j=a[e],k=j;if(l[f])if(j instanceof Array)for(var k=[],g=j.length;g--;)k.push(h(j[g]));else k=h(a[e],e);c.push(m(f,e,k))}else c.push(m("$eq",e,a));var n={exprs:c,k:b,test:function(a){return d(n,a)}};return n},l={$and:!0,
$or:!0,$nor:!0,$trav:!0,$not:!0},i={$eq:function(a,b){return a.test(b)},$ne:function(a,b){return!a.test(b)},$lt:function(a,b){return a>b},$gt:function(a,b){return a<b},$lte:function(a,b){return a>=b},$gte:function(a,b){return a<=b},$exists:function(a,b){return a==!!b},$in:function(a,b){if(b instanceof Array)for(var c=b.length;c--;){if(a.indexOf(b[c])>-1)return!0}else return a.indexOf(b)>-1},$not:function(a,b){return!a.test(b)},$type:function(a,b,c){return c?c instanceof a||c.constructor==a:!1},$nin:function(a,
b){return!i.$in(a,b)},$mod:function(a,b){return b%a[0]==a[1]},$all:function(a,b){for(var c=a.length;c--;)if(b.indexOf(a[c])==-1)return!1;return!0},$size:function(a,b){return b?a==b.length:!1},$or:function(a,b){for(var c=a.length,e=c;c--;)if(d(a[c],b))return!0;return!e},$nor:function(a,b){for(var c=a.length,e=c;c--;)if(!d(a[c],b))return!0;return!e},$and:function(a,b){for(var c=a.length;c--;)if(!d(a[c],b))return!1;return!0},$trav:function(a,b){if(b instanceof Array){for(var c=b.length;c--;){var e=b[c];
if(e[a.k]&&d(a,e[a.k]))return!0}return!1}return b?d(a,b[a.k]):!1}},f={$eq:function(a){var b;return a instanceof RegExp?a:{test:a instanceof Function?a:function(b){return a==b}}},$ne:function(a){return f.$eq(a)}},m=function(a,b,c){c=c instanceof Date?c.getTime():c;return{k:b,v:f[a]?f[a](c):c,e:i[a]}}},p=function(d){var h=o.parse(d),d=function(d){for(var i=[],f=0,g=d.length;f<g;f++)h.test(d[f])&&i.push(d[f]);return i};d.test=h.test;return d},g=function(d,h){var g=p(d);return h?g(h):g};if(typeof module!=
"undefined"&&typeof module.exports!="undefined")module.exports=g;else if(typeof window!="undefined")window.sift=g})();
